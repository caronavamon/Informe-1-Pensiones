---
title: "Si usar"
author: "VChU"
date: "2024-06-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


```{r}
Activos2023 <- activos %>% 
  select(
    ID,
    Edad,
    `ene/2023`,
    `feb/2023`,
    `mar/2023`,
    `abr/2023`,
    `may/2023`,
    `jun/2023`,
    `jul/2023`,
    `ago/2023`,
    `sep/2023`,
    `oct/2023`,
    `nov/2023`,
    `dic/2023`
  ) %>% 
  mutate(
    Salario =
      `ene/2023` +
      `feb/2023` +
      `mar/2023` +
      # `abr/2023` +
      `may/2023` +
      `jun/2023` +
      `jul/2023` +
      `ago/2023` +
      `sep/2023` +
      `oct/2023` +
      `nov/2023` +
      `dic/2023`
    
  ) %>% 
  select(
    ID,
    Edad,
    Salario
  ) %>% 
  mutate(
    as.data.frame(
      matrix(rep(Salario,100),ncol = 100,byrow = F)*(1+inflacion)*matrix(
        (1+variacion_proyectada$variacion[outer(
          Edad - 18,
          1:100,
          "+"
        )]
        ),
        ncol = 100
      )
    )
  )

for (k in 1:length(Activos2023$ID)) {
  Activos2023[k,4:103] <- cumprod(Activos2023[k,4:103])
}

```

```{r}
dfActivos <- lista_pensionados_activos[[5]]

Cotizaciones_Activos <- dfActivos %>% 
  select(
    ID,
    cont
  ) %>% 
  mutate(
    Fila = match(
      ID,
      Activos2023$ID
    )
  ) %>% 
  cbind(
    matrix(numeric(100*length(dfActivos$ID)),ncol = 100)
  )

for (i in 1:length(Cotizaciones_Activos$ID)) {
    Cotizaciones_Activos[i,3+1:Cotizaciones_Activos$cont[i]] <- Activos2023[Cotizaciones_Activos$Fila[i],3 + 1:Cotizaciones_Activos$cont[i]]
}
Cotizacion_Anuales <- colSums(Cotizaciones_Activos[4:103])*.15

View(data_frame(Cotizacion_Anuales))
```

```{r}
sum(Salarios_proyectados[!is.na(Salarios_proyectados[31]),31])
sum(Salarios_proyectados[Cotizaciones_Activos$Fila,31])
```

```{r}
sum(salarios_edad %>% 
  filter(
    AÃ±o == "2023" & !is.na(Salario)
  ) %>% 
    select(
      Salario
    ))
```


