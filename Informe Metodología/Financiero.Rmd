---
title: "FinancieroJM"
output: html_document
date: "2024-06-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Convertimos el dataframe de formato largo a formato ancho

Salarios_proyectados <- salarios_edad[,-4] %>%
  pivot_wider(names_from = Año, values_from = Salario) 


for (i in 1:100) {
  year <- 2023 + i
  Salarios_proyectados[[as.character(year)]] <- 0  # Agregar columnas vacías
}


Salarios_proyectados <- Salarios_proyectados %>% mutate(edad = activos$Edad)
```


```{r}
  # Proyectar el salario con inflacion

for (i in 1:100) { 
  year <- 2023 + i
  previo <- as.character(2023 + i - 1)
  actual <- as.character(year)
  

  Salarios_proyectados[[actual]] <- Salarios_proyectados[[previo]]* (1 + inflacion)
}
```


```{r}
# Se crea df para tener la variacion de salarios
escalaSalariosedad <-  Salarios_proyectados[, c("ID", "edad")]
anios <- as.character(1994:2123)
escalaSalariosedad[anios] <- NA
escalaSalariosedad[,3:32] <- 1
```

```{r}
# Se obtiene la varicion según edad en cada año a cada individuo
for (i in 1:nrow(escalaSalariosedad)) {
  for (j in 2024:2123) {
    current_age <- escalaSalariosedad$edad[i] + (j - 2023)
    
    if (current_age > 115) {
      break  # Si la edad actual es mayor a 78, salir del bucle interno
    }
    
    variacion <- variacion_proyectada$variacion[variacion_proyectada$edad == current_age]
    if (length(variacion) > 0) {  # Verificar que se encontró una variación
      escalaSalariosedad[i, as.character(j)] <- 1 + variacion
    }
  }
}
```

```{r}
#Se hace la proyección final con inflación y escala salarial

ID <- Salarios_proyectados$ID
Edad <- Salarios_proyectados$edad


productos <- Salarios_proyectados[, as.character(anios)] * escalaSalariosedad[, as.character(anios)]


ProyeccionSalarios <- data.frame(ID, Edad, productos)

nombres_columnas <- colnames(ProyeccionSalarios)

nuevos_nombres <- gsub("^X", "", nombres_columnas)


colnames(ProyeccionSalarios) <- nuevos_nombres

```






